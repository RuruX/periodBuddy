<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>经日天气</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="wrap">
    <header class="header">
      <div class="title">
        <h1>经日天气晴</h1>
        <p class="sub">经期能量雷达｜每日建议卡片｜ 和 Sunnie 对话</p>
      </div>
      <div class="badge">仅供参考 · 非医疗建议</div>
    </header>

    <section class="card">
      <h2>输入</h2>
      <div class="grid">
        <label>
          上次月经第一天
          <input id="lastStart" type="date" />
        </label>

        <label>
          经期持续（天，3–8）
          <input id="periodLen" type="number" min="3" max="8" value="5" />
        </label>

        <label>
          平均周期（天，28–35）
          <input id="cycleLen" type="number" min="28" max="35" value="30" />
        </label>

        <button id="btn">计算</button>
      </div>

      <div class="row">
        <div class="chartBox">
          <div class="rangeBar">
            <div class="rangeLeft">
              <div class="rangeTitle">能量回顾 / 预测</div>
              <div class="rangeSub" id="rangeLabel">-</div>
            </div>
            <input id="dayOffset" class="slider" type="range" min="-3" max="3" value="0" step="1" />
          </div>

          <canvas id="radar" height="320"></canvas>
          <div class="hint">说明：雷达图范围 0–100；界面不显示刻度数字与悬浮提示数字。</div>
        </div>

        <div class="meta">
          <div class="kv"><span>所选日期：</span><b id="chosenDate">-</b></div>
          <div class="kv"><span>周期第</span><b id="dayInCycle">-</b><span>天</span></div>
          <div class="kv"><span>阶段：</span><b id="phase">-</b></div>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>每日建议卡片</h2>
      <p class="sub">根据所选日期的阶段 + 五维强弱，给出行动建议（运动 / 工作 / 休息 / 亲密）。</p>
      <div class="cards" id="adviceCards"></div>
    </section>

    <section class="card">
      <h2>Sunnie 对话</h2>
      <p class="sub">
        这里是可接入 AI agent 的对话框（默认本地 Mock）。
        你可以在 <code>app.js</code> 里把 <code>MODEL.aiAgent.mode</code> 改成 <b>fetch</b> 或 <b>window</b> 来对接真实 agent。
      </p>

      <div class="chat">
        <div class="chatHeader">
          <img class="avatar" alt="Sunnie 头像（晴天娃娃）" src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%2796%27%20height%3D%2796%27%20viewBox%3D%270%200%2096%2096%27%3E%0A%3Cdefs%3E%0A%20%20%3ClinearGradient%20id%3D%27g%27%20x1%3D%270%27%20y1%3D%270%27%20x2%3D%270%27%20y2%3D%271%27%3E%0A%20%20%20%20%3Cstop%20offset%3D%270%27%20stop-color%3D%27%23ffffff%27/%3E%0A%20%20%20%20%3Cstop%20offset%3D%271%27%20stop-color%3D%27%23f1f4ff%27/%3E%0A%20%20%3C/linearGradient%3E%0A%3C/defs%3E%0A%3Crect%20width%3D%2796%27%20height%3D%2796%27%20rx%3D%2748%27%20fill%3D%27%23ffffff%27/%3E%0A%3C%21--%20little%20sun%20--%3E%0A%3Ccircle%20cx%3D%2774%27%20cy%3D%2722%27%20r%3D%2710%27%20fill%3D%27%23ffcc33%27%20stroke%3D%27%23f2b400%27%20stroke-width%3D%272%27/%3E%0A%3Cg%20stroke%3D%27%23f2b400%27%20stroke-width%3D%272%27%20stroke-linecap%3D%27round%27%3E%0A%20%20%3Cline%20x1%3D%2774%27%20y1%3D%276%27%20x2%3D%2774%27%20y2%3D%272%27/%3E%0A%20%20%3Cline%20x1%3D%2774%27%20y1%3D%2742%27%20x2%3D%2774%27%20y2%3D%2746%27/%3E%0A%20%20%3Cline%20x1%3D%2758%27%20y1%3D%2722%27%20x2%3D%2754%27%20y2%3D%2722%27/%3E%0A%20%20%3Cline%20x1%3D%2790%27%20y1%3D%2722%27%20x2%3D%2794%27%20y2%3D%2722%27/%3E%0A%20%20%3Cline%20x1%3D%2763%27%20y1%3D%2711%27%20x2%3D%2760%27%20y2%3D%278%27/%3E%0A%20%20%3Cline%20x1%3D%2785%27%20y1%3D%2733%27%20x2%3D%2788%27%20y2%3D%2736%27/%3E%0A%20%20%3Cline%20x1%3D%2763%27%20y1%3D%2733%27%20x2%3D%2760%27%20y2%3D%2736%27/%3E%0A%20%20%3Cline%20x1%3D%2785%27%20y1%3D%2711%27%20x2%3D%2788%27%20y2%3D%278%27/%3E%0A%3C/g%3E%0A%3C%21--%20teru%20teru%20bozu%20--%3E%0A%3Cpath%20d%3D%27M48%2018c-14%200-22%2010-22%2022%200%208%203%2015%209%2020l-7%2020h40l-7-20c6-5%209-12%209-20%200-12-8-22-22-22z%27%20fill%3D%27url%28%23g%29%27%20stroke%3D%27%23d9deee%27%20stroke-width%3D%272%27/%3E%0A%3Cpath%20d%3D%27M30%2058h36%27%20stroke%3D%27%23d9deee%27%20stroke-width%3D%272%27%20stroke-linecap%3D%27round%27/%3E%0A%3Ccircle%20cx%3D%2740%27%20cy%3D%2740%27%20r%3D%273%27%20fill%3D%27%23101322%27/%3E%0A%3Ccircle%20cx%3D%2756%27%20cy%3D%2740%27%20r%3D%273%27%20fill%3D%27%23101322%27/%3E%0A%3Cpath%20d%3D%27M42%2048c2%202%2010%202%2012%200%27%20stroke%3D%27%23101322%27%20stroke-width%3D%272%27%20fill%3D%27none%27%20stroke-linecap%3D%27round%27/%3E%0A%3Cpath%20d%3D%27M48%2060c0%200-6%207-10%2010%27%20stroke%3D%27%23c9cfe6%27%20stroke-width%3D%272%27%20stroke-linecap%3D%27round%27/%3E%0A%3Cpath%20d%3D%27M48%2060c0%200%206%207%2010%2010%27%20stroke%3D%27%23c9cfe6%27%20stroke-width%3D%272%27%20stroke-linecap%3D%27round%27/%3E%0A%3C/svg%3E" />
          <div class="chatHeaderText">
            <div class="chatName">Sunnie</div>
            <div class="chatStatus">晴天娃娃 · 轻量建议助手</div>
          </div>
        </div>

        <div id="chatLog" class="chatLog" aria-label="聊天记录"></div>

        <div class="chatBar">
          <textarea id="chatInput" rows="2" placeholder="例如：这天适合做力量训练吗？工作怎么安排更舒服？（⌘/Ctrl + Enter 发送）"></textarea>
          <button id="chatSend">发送</button>
        </div>

        <div class="chatHint">
          接口约定示例：
          <code>POST /api/agent</code>，body: <code>{message, context}</code>，返回：<code>{reply}</code>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div>提示：把 JS 模型抽到单独文件后，可以复用到 iOS / 微信小程序等不同 UI 壳里。</div>
    </footer>
  </div>

  <script src="app.js"></script>
</body>
</html>
